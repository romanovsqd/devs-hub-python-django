{% extends "base.html" %}
{% load static %}
{% load card_tags %}


{% block title %}
  {{ deck.title|striptags }}
{% endblock title %}

{% block content %}
  <div class="flex flex-col flex-1 py-8">
    <div class="container mx-auto px-4 flex flex-col flex-1">

      <div class="mb-10">
        {% if deck.author == request.user %}
          <div class="max-w-5xl mx-auto flex gap-4 justify-center items-center">
            <a href="{% url "deck_update" deck.pk %}" class="inline-block w-full text-center rounded-full py-4 px-6 text-md font-medium primary mb-2">Редактировать колоду</a>
            <a href="{% url "deck_export" deck.pk %}" class="inline-block w-full text-center rounded-full py-4 px-6 text-md font-medium success mb-2">Экспортировать колоду</a>
            <a href="{% url "deck_delete" deck.pk %}" class="inline-block w-full text-center rounded-full py-4 px-6 text-md font-medium danger mb-2">Удалить колоду</a>
          </div>
        {% else %}
          <form action="{% url "deck_toggle_save" deck.id %}" method="post" data-js-toggle-save-form>
            {% csrf_token %}
            <div class="max-w-5xl mx-auto flex gap-4 justify-center items-center">
              {% if not is_saved %}
                <button type="submit" data-js-toggle-button class="w-full rounded-full py-4 px-6 text-md font-medium primary transition-colors cursor-pointer">
                  Сохранить колоду в мой профиль
                </button>
                <a href="{% url "deck_export" deck.pk %}" data-js-export-button class="inline-block w-full text-center rounded-full py-4 px-6 text-md font-medium success inactive mb-2">Экспортировать колоду</a>
              {% else %}
                <button type="submit" data-js-toggle-button class="w-full rounded-full py-4 px-6 text-md font-medium danger transition-colors cursor-pointer">
                  Удалить колоду из моего профиля
                </button>
                <a href="{% url "deck_export" deck.pk %}" data-js-export-button class="inline-block w-full text-center rounded-full py-4 px-6 text-md font-medium success mb-2">Экспортировать колоду</a>
              {% endif %}
            </div>
          </form>
        {% endif %}
      </div>

      <div class="mb-8">
        {% include "includes/title.html" with title="Список карточек" %}
      </div>

      <div class="max-w-1/2 w-full mx-auto mb-8">
        {% include "includes/search_form.html" with placeholder="Что такое итератор?" %}
      </div>

      <div class="mb-auto">
        {% include "includes/card_list.html" with cards=cards user=request.user %}
      </div>

      <div class="pt-8">
        {% include "includes/pagination.html" with page_obj=cards %}
      </div>

  </div>
</div>

{% endblock content %}

{% block scripts %}
  <script src="{% static "js/toggle_form_state.js" %}"></script>
{% endblock scripts %}
